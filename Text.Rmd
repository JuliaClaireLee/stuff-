---
title: "Untitled"
author: "Julia Lee"
date: "5/25/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(mdsr)
```

```{r}
Hamlet_url <-"http://www.gutenberg.org/cache/epub/2265/pg2265.txt"
Hamlet_Raw<-RCurl::getURL(Hamlet_url)
Hamlet<-strsplit(Hamlet_Raw, "\r\n")[[1]]
length(Hamlet)
View(Hamlet)
HAMLET <-grepl(" Hamlet\\ ." , Hamlet)
OPHELIA <-grepl(" Ophelia\\ ." , Hamlet)
POLONIUS <-grepl(" Polonius\\ ." , Hamlet)
HORATIO <-grepl(" Horatio\\ ." , Hamlet)
LAERTES <-grepl(" Laretes\\ ." , Hamlet)
Claudius <-grepl(" Claudius\\ .", Hamlet)

``` 

```{r}
freq <-data.frame(HAMLET, POLONIUS, HORATIO, LAERTES, Claudius, OPHELIA ) %>%
  mutate(line = 1:length(Hamlet)) %>%
  gather(key = "character", value = "speak", -line) %>%
  mutate(speak = as.numeric(speak)) %>%
filter(line > 255 & line < 5298)
glimpse(freq)
```

```{r}
idx <-grep("ACT[I|V]+", Hamlet)
label <- str_extract(Hamlet[idx], "ACT[I|V]+")
act <-data.frame(line = idx, labels = label)

```

```{r}
ggplot(data = freq, aes(x = line, y = speak)) + 
  geom_smooth(aes(color = character), method = "loess", se = 0, span = 0.75) +
  geom_vline(xintercept = idx, color = "darkgray", lty = 3) +
 xlab("Line Number") + 
  ylab("Proportion of Speeches")
```


